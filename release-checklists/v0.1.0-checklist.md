# v0.1.1 Release Checklist

This checklist is organized into three categories based on who/what executes the tests.

---

## Category 1: CI Tests (Fully Automatic)

These run automatically on every push/PR via GitHub Actions. No manual action required.

| Test | Command | CI Job |
|------|---------|--------|
| Backend lint | `ruff check .` | `backend-lint` |
| Backend type check | `mypy app --ignore-missing-imports` | `backend-lint` |
| Backend tests | `pytest -v --tb=short` | `backend-test` |
| Frontend lint | `npm run lint` | `frontend-lint` |
| Frontend build | `npm run build` | `frontend-build` |
| Docker image build | `docker build` | `docker-build` |

### How to verify

1. Check the CI status badge in README.md
2. Or visit: https://github.com/seethroughlab/familliar/actions
3. All jobs must show green checkmarks before release

---

## Category 2: Claude Code Automated Tests

These tests can be run and evaluated locally by Claude Code. They don't require human judgment.

### Instructions for Claude Code

Run these commands and verify the expected outputs:

### 2.1 Docker Environment

```bash
# Start containers
cd /Users/jeff/Developer/familliar
docker compose -f docker/docker-compose.local.yml up -d

# Verify all containers are running and healthy
docker compose -f docker/docker-compose.local.yml ps
# Expected: All services show "Up" and "healthy"

# Check for startup errors
docker compose -f docker/docker-compose.local.yml logs --tail=50 | grep -i error
# Expected: No critical errors
```

### 2.2 API Health Checks

```bash
# Health endpoint
curl -s http://localhost:4400/api/v1/health | jq
# Expected: {"status": "ok", ...}

# API root
curl -s http://localhost:4400/api/v1/ | jq
# Expected: Returns API info or redirects to docs

# Tracks endpoint (requires profile)
curl -s http://localhost:4400/api/v1/tracks | jq
# Expected: Returns track list or empty array
```

### 2.3 Settings API

```bash
# Get settings
curl -s http://localhost:4400/api/v1/settings | jq
# Expected: Returns settings object

# Profiles list
curl -s http://localhost:4400/api/v1/profiles | jq
# Expected: Returns array of profiles
```

### 2.4 Library Scan API

```bash
# Start a scan (requires music library path to be configured)
curl -s -X POST http://localhost:4400/api/v1/library/scan | jq
# Expected: {"status": "started", ...} or {"status": "already_running", ...}

# Check scan status
curl -s http://localhost:4400/api/v1/library/scan/status | jq
# Expected: Returns scan progress or idle status
```

### 2.5 Backend Tests (Local)

```bash
cd /Users/jeff/Developer/familliar/backend
DATABASE_URL="postgresql+asyncpg://familiar:familiar@localhost:5432/familiar" \
REDIS_URL="redis://localhost:6379/0" \
uv run pytest -v --tb=short
# Expected: All tests pass
```

### 2.6 Frontend Build (Local)

```bash
cd /Users/jeff/Developer/familliar/frontend
npm run build
# Expected: Build completes without errors
```

---

## Category 3: Human Testing Required

These tests require human senses, judgment, or interactive browser use.

### 3.1 Audio Playback

- [ ] Click a track - audio plays
- [ ] Audio sounds correct (not distorted, correct speed)
- [ ] Play/pause button toggles playback
- [ ] Progress bar shows current position
- [ ] Clicking progress bar seeks to that position
- [ ] Volume slider changes volume
- [ ] Next/previous track buttons work
- [ ] Gapless playback between tracks (no gaps or clicks)
- [ ] Shuffle mode randomizes order
- [ ] Repeat mode loops track/playlist

### 3.2 Visual Elements

- [ ] Album artwork displays correctly
- [ ] UI loads without visual glitches
- [ ] Visualizer responds to audio frequencies
- [ ] Visualizer fullscreen mode works
- [ ] Queue displays correctly
- [ ] Library grid/list views work

### 3.3 AI Chat

- [ ] Add Anthropic API key in Admin panel
- [ ] Key saves successfully (no error)
- [ ] Send message: "Play something upbeat"
- [ ] AI responds and creates playlist
- [ ] Playlist starts playing automatically
- [ ] Chat shows helpful error if no API key configured

### 3.4 Spotify Integration

- [ ] Add Spotify client ID/secret in Admin panel
- [ ] "Connect to Spotify" button appears after saving
- [ ] OAuth flow opens Spotify login
- [ ] After auth, shows "Connected as [username]"
- [ ] "Sync Favorites" starts sync task with progress
- [ ] Matched/unmatched counts display after sync
- [ ] Disconnect button works

### 3.5 Last.fm Integration

- [ ] Add Last.fm API key/secret in Admin panel
- [ ] "Connect Last.fm" button appears after saving
- [ ] OAuth flow completes
- [ ] Shows "Connected as [username]"
- [ ] Play a track for 30+ seconds
- [ ] Check last.fm profile - scrobble appears

### 3.6 Playlists

- [ ] Create new playlist (button works)
- [ ] Add tracks to playlist via UI
- [ ] Rename playlist
- [ ] Delete playlist
- [ ] AI-generated playlists appear in list
- [ ] Drag to reorder tracks in playlist

### 3.7 Profiles

- [ ] Create a new profile
- [ ] Upload profile avatar image
- [ ] Rename profile
- [ ] Switch between profiles
- [ ] Delete profile (except last one blocked)

### 3.8 PWA & Offline

- [ ] Install app prompt appears (requires HTTPS)
- [ ] App installs to home screen/desktop
- [ ] Cache a playlist for offline
- [ ] Disconnect network
- [ ] Cached tracks still play
- [ ] Media controls on lock screen work

### 3.9 Listening Sessions (WebRTC)

- [ ] Start a listening session
- [ ] Copy share link
- [ ] Open link in different browser/device
- [ ] Guest connects and sees now playing
- [ ] Audio plays in sync for both
- [ ] Host controls affect guest playback

### 3.10 Platform Testing

- [ ] Docker on x86 Linux/Mac/Windows
- [ ] OpenMediaVault installation per README
- [ ] Synology NAS via Container Manager
- [ ] ARM64 with `DISABLE_CLAP_EMBEDDINGS=true`

---

## Pre-Release Final Checks

- [ ] CHANGELOG.md updated with all changes since last release
- [ ] README.md is accurate and up-to-date
- [ ] No console errors in browser DevTools
- [ ] No ERROR level logs in container output
- [ ] CI passes on master branch
- [ ] Git tag created: `git tag v0.1.1`
- [ ] GitHub release created with release notes
